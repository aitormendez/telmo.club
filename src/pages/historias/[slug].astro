---
import { getCollection } from "astro:content";
import SiteLayout from "../../layouts/SiteLayout.astro";

export async function getStaticPaths() {
  const historias = await getCollection("historias");
  return historias.map((entry) => ({
    params: {
      slug:
        entry.id.replace(/^historias\//, "").split("/")[0] ||
        entry.slug.split("/").pop() ||
        entry.slug,
    },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const date = entry.data.date;
const formattedDate =
  date &&
  date.toLocaleDateString("es-ES", {
    day: "numeric",
    month: "long",
    year: "numeric",
  });
---

<SiteLayout title={`${entry.data.title} | historias`}>
  <main class="px-5 sm:px-6 py-10 flex justify-center">
    <article class="w-full max-w-3xl space-y-4">
      <div class="space-y-1">
        <h1 class="text-4xl leading-tight">{entry.data.title}</h1>
        {formattedDate && <p class="">{formattedDate}</p>}
      </div>
      <div class="prose max-w-none">
        <Content />
      </div>
    </article>
  </main>
</SiteLayout>
