---
import "../styles/app.css";

interface Props {
  title?: string;
}

const { title = "telmo" } = Astro.props as Props;
---

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
  </head>
  <body class="bg-white text-black antialiased">
    <header
      class="relative z-20 flex items-center justify-between px-5 sm:px-6 pt-5"
    >
      <a href="/" class="text-2xl font-bold !text-black hover:!text-sky-700"
        >telmo</a
      >
      <button id="menu-toggle" class="w-9 h-9" aria-label="Abrir menú">
        <img
          id="menu-icon"
          src="/svg/menu.svg"
          alt="Menú"
          class="w-full h-full"
        />
      </button>
    </header>

    <slot />

    <div
      id="nav-overlay"
      class="fixed inset-0 z-10 bg-white/95 backdrop-blur-sm px-5 sm:px-6 py-16 flex flex-col"
      style="display:none; opacity:0; transform: translateX(-100%);"
    >
      <nav class="flex flex-col text-sky-700 text-2xl leading-none">
        <a href="/merz">merz</a>
        <a href="/mapa">mapa</a>
        <a href="/conversaciones">conversaciones</a>
        <a href="/historias">historias</a>
        <a href="/projects">proyectos</a>
        <a href="/que">¿qué?</a>
      </nav>
    </div>

    <script type="module">
      import { gsap } from "https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js";

      const overlay = document.getElementById("nav-overlay");
      const btnToggle = document.getElementById("menu-toggle");
      const icon = document.getElementById("menu-icon");

      if (overlay && btnToggle && icon) {
        const tl = gsap.timeline({
          paused: true,
          defaults: { duration: 0.3, ease: "power1.out" },
        });

        tl.set(overlay, { display: "flex" })
          .fromTo(
            overlay,
            { x: "-100%", opacity: 0 },
            { x: "0%", opacity: 1 }
          )
          .eventCallback("onReverseComplete", () => {
            overlay.style.display = "none";
          });

        let isOpen = false;

        const open = () => {
          isOpen = true;
          icon.src = "/svg/cerrar.svg";
          tl.play(0);
        };

        const close = () => {
          isOpen = false;
          icon.src = "/svg/menu.svg";
          tl.reverse();
        };

        btnToggle.addEventListener("click", () => {
          if (isOpen) {
            close();
          } else {
            open();
          }
        });
      } else {
        console.warn("Menú: faltan elementos en el DOM");
      }
    </script>
  </body>
</html>
